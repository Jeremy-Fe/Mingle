 <!DOCTYPE html>
<html lang="kr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <title>search</title>

    <!--css-->
    <link href="/CSS/search2.css?after" type="text/css" rel="stylesheet">

    <!-- include jQuery :) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>

    <!-- jQuery Modal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

    <!--font-->
    <!--font-family: 'GmarketSans';-->
    <link href="https://webfontworld.github.io/gmarket/GmarketSans.css" rel="stylesheet">
    <!--font-family: 'Orbitron', sans-serif;-->
    <link href="https://webfontworld.github.io/goodchoice/Jalnan.css" rel="stylesheet">
    <!--font-family: 'Jalnan';-->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <!-- font-family: 'NexonLv1Gothic'; -->
    <link href="https://webfontworld.github.io/NexonLv1Gothic/NexonLv1Gothic.css" rel="stylesheet">
</head>
<body>

      <div th:replace="/defaultUI.html"></div>
            <!-- 바꿔야하는 부분 -->
            <div class="view">

              <!-- 검색창 -->
              <div id="search">
                <ul>
                    <a id="regi" href="/selectRegi" rel="modal:open" style="display: block">
                    <img src="image/search_지역.png">
                    <p id="selectedRegi">전체</p>
<!--                    <p  th:unless="${selectedRegion == null}" th:text="${selectedRegion}"></p>-->
                    <img src="image/오른쪽화살표.png">
                   </a>
                    <img id="search_I"  class="search" src="image/search_검색버튼.png">
                    <input type="search" name="" id="Stext" placeholder="이름으로 검색하기.">
                </ul>
              </div>
              
              <!-- 검색 모임 -->
              <section id="chMingle">
                <!-- 검색 모임 헤더 -->
                <header id="cM_header">
                  <a id="mainC" href="#">
                    <img src="image/inter/운동스포츠.png">
                    <p id="mainCtName">전체</p>
                  </a>
                  <a id="subC" href="#">전체<img src="image/오른쪽화살표.png"></a>
                  <button id="array">최신순</button><!--onclick="update()"-->
                </header>
                <!-- / 검색 모임 헤더 -->

                <div id="inMingle" style="overflow:scroll;">

                </div>
              </section>
              <!-- / 관심사 -->

            </div>

        </div>



    </section>
</div>
<script>
// 검색창
$("#Stext").focus(function(){
  $("#regi").hide();
  /*$("관심사").show();*/
	$("#Stext").animate({
			"width": "1290px"
	}, 300, function() {});
});
$("#Stext").blur(function(){
  $("#regi").show(150);
	$("#Stext").animate({
			"width": "450px"
	}, 100, function() {});
});



window.onload = function() {
    var 추출한텍스트 = document.getElementById("selectedRegi").textContent;
    var 띄어쓰기_인덱스 = 추출한텍스트.indexOf(" ");
    var 선택한지역 = 추출한텍스트.substring(띄어쓰기_인덱스 + 1);

    console.log("선택한 지역 = " + 선택한지역);

    var 메인카테고리= document.getElementById("mainCtName").textContent;
    console.log("메인카테고리= "+메인카테고리);

    var 세부카테고리= document.getElementById("subC").textContent;
    console.log("세부카테고리 = "+세부카테고리);
    $.ajax({
        url: "search2/searchMingle",
        type : 'GET',
        data : {selectedRegi: 선택한지역,mainCtName: 메인카테고리,subC: 세부카테고리},
        success: function(response) {
/*            var 모임카드초기화 = document.getElementsByClassName("mingle");
            모임카드초기화.remove();*/
            $(".mingle").remove();
            console.log("response = "+response)
            console.log("선택한지역: "+ 선택한지역+" 메인카테고리: "+메인카테고리+" 세부카테고리: "+세부카테고리);
            for (var i = 0; i < response.length; i++) {
                var mingles = response[i];
                console.log("response[i] =", mingles);
                var 모임명 = mingles.gname;
                var 모임이미지 = mingles.gcoverimg;
                var 모임카테고리 = mingles.gmainsubject;
                var 모임지역 = (mingles.gcity)+" "+(mingles.gdistrict);
                var 모임소개글 = mingles.gintroduction;
                console.log("ajax : 모임명 확인 =", 모임명);
                console.log("ajax : response.length+1 확인 =", response.length);
                var htmlMingle =
                    '<div class="mingle">\n' +
                    '<ul>\n' +
                    '<img src="'+모임이미지+'">\n' +
                    '<li id="mTitle"><h4>'+모임명+'</h4> <img src=""></li>\n' +
                    '<li id="mCategorie">'+모임카테고리+'</li>\n' +
                    '<li id="mRogi">'+모임지역+'</li>\n' +
                    '<li id="mUser"><a href="#">'+96+'</a>명이 참여 중</li>\n' +
                    '</ul>\n' +
                    '<p id="mIntd">'+모임소개글+'</p>\n' +
                    '</div>';

                $("#inMingle").append(htmlMingle);
                $("#search_I").click(function() {
                    console.log("검색")
                    const 검색한이름 = document.getElementById('Stext').value;
                    console.log("검색한이름 : "+검색한이름);
                    $.ajax({
                        url: "search2/searchName",
                        type : 'GET',
                        data : {searchName : 검색한이름},
                        success: function(response) {
                        },
                        error: function(xhr, status, error) {
                            console.error(error);
                        }
                    });
                });

            }
        },
        error: function(xhr, status, error) {
            console.error(error);
        }
    });
}
/*$("#search_I").click(function() {
    console.log("검색")
    /!* const 검색한이름 = document.getElementById('Stext').value;
     console.log("검색한이름 : "+검색한이름);
     $.ajax({
         url: "search2/searchName",
         type : 'GET',
         data : {searchName : 검색한이름},
         success: function(response) {
         },
         error: function(xhr, status, error) {
             console.error(error);
         }
     });*!/
});*/



</script>
</body>
</html> 